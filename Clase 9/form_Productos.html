<!DOCTYPE html>
<html lang="en">

<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/front.css">
    <title>Document</title>
</head>

<body>

    
    
        <div class="form-container">
            <h1>Formulario de Productos</h1>
            <form action=""></form>
                <div class="form-row">
                    <div class="form-group">
                      <label for="nombre">Title</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="email">Price</label>
                    <input type="number" id="email" name="email" required>
                </div>  
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="Username">Description</label>
                    <input type="text" id="username" name="username" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="category">Category</label>
                    <input type="text" id="category" name="category" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="image">Image</label>
                    <input type="image" id="image" name="image" required>
                </div>
            </div>

            <!-- Botón de envío -->
            <div class="form-group">
                <button type="submit" class="submit-btn">Enviar Formulario</button>
            </div>
        </div>
    </form>



</body>
<script src="./javascript/jquery.js"></script>

<script>
    window.onload = async function () {
        const urlParams = new URLSearchParams(window.location.search);
        const usuario = await getUsuario(urlParams.get('id'));
        $('#username').val(usuario.username);
        $('#nombre').val(usuario.name);
        $('#email').val(usuario.email);
        $('#id').val(usuario.id);

        window.__originalUsuario = usuario;
        sessionStorage.setItem('usr_${usuario.id}_original', JSON.stringify(usuario));
    }
       const regex = {
    nombre: /^[A-Za-zÀ-ÿ'´`¨^.\-\s]{2,60}$/,
    apellido: /^[A-Za-zÀ-ÿ'´`¨^.\-\s]{2,60}$/,
    email: /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/,
    password: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9\s]).{8,}$/,
};

$('form').on('submit', function(e) {
    e.preventDefault();

    const nombre   = $('#nombre').val();
    const apellido = $('#apellido').val();
    const email    = $('#email').val();
    const password = $('#password').val();

    if (nombre && !regex.nombre.test(nombre.trim())) {
        alert('El nombre solo debe contener letras y tener entre 2 y 60 caracteres.');
        return;
    }

    if (!regex.apellido.test(apellido.trim())) {
        alert('El apellido solo debe contener letras y tener entre 2 y 60 caracteres.');
        return;
    }

    if (!regex.email.test(email.trim())) {
        alert('Ingresa un correo electrónico válido.');
        return;
    }

    if (password && !regex.password.test(password.trim())) {
        alert('La contraseña debe tener al menos 8 caracteres, incluir mayúsculas, minúsculas, un número y un carácter especial.');
        return;
    }
    if(password !== confirm_password){
        
    }

    const queryString = '?nombre=${encodeURIComponent(nombre)}&password=${encodeURIComponent(password)}';
    window.location.href = "registro_data.html" + queryString;
    
});

async function getUsuario(id) {
  try {
    // 1. Define la URL del endpoint de la API
    const url = 'https://fakestoreapi.com/products' + id; // Ejemplo de URL

    // 2. Realiza la petición GET usando fetch
    const respuesta = await fetch(url);

    // 3. Convierte la respuesta a formato JSON
    const datos = await respuesta.json();

    // 4. Utiliza los datos
    console.log(datos); // Muestra los datos en la consola
    return datos; //devuelve los datos para usarlos en loadTableData
    // Aquí podrías actualizar la interfaz de usuario, por ejemplo
  } catch (error) {
    console.error('Error al consumir la API:', error);
  }
}                              

</script>
</html>